<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Redirecting to Squareyes...</title>
  <script>
    (function () {
      const params = new URLSearchParams(window.location.search);
      const page = params.get("page");
      const type = params.get("type");
      const id = params.get("id");

      if (!page || !type || !id) {
        // Invalid parameters â€“ fallback to TMDb homepage
        window.location.href = "https://www.themoviedb.org";
        return;
      }

      const appUrl = `squareyes://link?page=${page}&type=${type}&id=${id}`;
      const fallbackUrl = (() => {
        if (page === "details" && (type === "film" || type === "tv")) {
          return `https://www.themoviedb.org/${type}/${id}`;
        } else if (page === "bio" && type === "person") {
          return `https://www.themoviedb.org/person/${id}`;
        } else if (page === "bio" && type === "company") {
          return `https://www.themoviedb.org/company/${id}`;
        } else {
          return "https://www.themoviedb.org";
        }
      })();

      const iosAppStoreUrl = "https://apps.apple.com/app/squareyes/id1061103845";

      const now = Date.now();
      window.location = appUrl;

      // After 1.5 seconds, if app hasn't opened, fallback to App Store or TMDb
      setTimeout(() => {
        const elapsed = Date.now() - now;
        if (elapsed < 1600) {
          const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);
          window.location.href = isIOS ? iosAppStoreUrl : fallbackUrl;
        }
      }, 1500);
    })();
  </script>
</head>
<body>
  <p>Redirecting to Squareyes...</p>
</body>
</html>
